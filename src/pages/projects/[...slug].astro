---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  return projects.map((project) => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await project.render();
---

<BaseLayout
  title={`${project.data.title} — Projects`}
  description={project.data.description}
  image={project.data.image}
>
  <div class="container mx-auto px-6">
    <article class="max-w-3xl mx-auto">
      <header class="mb-section">
        {project.data.image && (
          <div class="mb-6 aspect-video bg-gray-100 rounded-lg overflow-hidden animate-fade-in-up">
            <img
              src={project.data.image}
              alt={project.data.title}
              class="w-full h-full object-cover"
            />
          </div>
        )}
        
        <h1 class="text-hero font-bold mb-4 tracking-tight animate-fade-in-up" style="animation-delay: 0.1s;">
          {project.data.title}
        </h1>
        
        <p class="text-lg text-gray-700 mb-6 animate-fade-in-up" style="animation-delay: 0.2s;">
          {project.data.description}
        </p>
        
        <div class="flex items-center gap-4 flex-wrap mb-4 animate-fade-in-up" style="animation-delay: 0.3s;">
          {project.data.demoUrl && (
            <a
              href={project.data.demoUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="px-4 py-2 bg-gray-900 text-white rounded font-mono text-sm hover:bg-gray-800 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"
            >
              {project.data.demoUrl.includes('devspot') ? 'View on Devpost →' : 'View Demo →'}
            </a>
          )}
          {project.data.githubUrl && (
            <a
              href={project.data.githubUrl}
              target="_blank"
              rel="noopener noreferrer"
              class="px-4 py-2 bg-gray-100 text-gray-900 rounded font-mono text-sm hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"
            >
              View on GitHub →
            </a>
          )}
        </div>
        
        <div class="flex flex-wrap gap-2 mb-4 animate-fade-in-up" style="animation-delay: 0.4s;">
          {project.data.techStack.map((tech) => (
            <span class="px-3 py-1 bg-gray-100 rounded text-sm font-mono text-gray-700 transition-all duration-200 ease-out hover:bg-gray-900 hover:text-white hover:scale-105 hover:shadow-md cursor-default transform-gpu">
              {tech}
            </span>
          ))}
        </div>
        
        <time
          datetime={project.data.publishDate.toISOString()}
          class="text-sm font-mono text-gray-500 animate-fade-in-up"
          style="animation-delay: 0.5s;"
        >
          Published {project.data.publishDate.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
          })}
        </time>
      </header>

      <div class="text-lg text-gray-700 leading-relaxed space-y-6 animate-fade-in-up [&_h2]:text-2xl [&_h2]:font-semibold [&_h2]:mt-8 [&_h2]:mb-4 [&_h2]:text-gray-900 [&_h3]:text-xl [&_h3]:font-semibold [&_h3]:mt-6 [&_h3]:mb-3 [&_h3]:text-gray-900 [&_p]:mb-4 [&_ul]:list-disc [&_ul]:ml-6 [&_ul]:mb-4 [&_ol]:list-decimal [&_ol]:ml-6 [&_ol]:mb-4 [&_li]:mb-2 [&_code]:bg-gray-100 [&_code]:px-1.5 [&_code]:py-0.5 [&_code]:rounded [&_code]:text-sm [&_code]:font-mono [&_pre]:bg-gray-50 [&_pre]:border [&_pre]:border-gray-200 [&_pre]:p-4 [&_pre]:rounded [&_pre]:overflow-x-auto [&_pre]:mb-4 [&_pre]:text-gray-900 [&_pre_code]:bg-transparent [&_pre_code]:p-0 [&_a]:text-gray-900 [&_a]:underline [&_a]:hover:text-gray-600">
        <Content />
      </div>
    </article>
  </div>
</BaseLayout>

